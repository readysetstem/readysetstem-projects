<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
 <meta name="generator" content=
 "HTML Tidy for HTML5 for Mac OS X version 5.1.25">
 <meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8">
 <title></title>
 <link rel="stylesheet" type="text/css" href="default.css">
 <link rel="stylesheet" type="text/css" href="project.css">
 <link type="text/css" rel="stylesheet" href="/assets/cmirror/codemirror.css">
 <link type="text/css" id="theme" rel="stylesheet" href=
 "/assets/themes/solarized-dark.css">
 <script type="text/javascript" src="/assets/cmirror/codemirror.js">
 </script>
 <script type="text/javascript" src="/assets/cmirror/python.js">
 </script>
 <script type="text/javascript" src="onload.js">
 </script>
 <script type="text/javascript" src="flows.js">
 </script>
 <script type="text/javascript" src="flow_cookie.js">
 </script>
 <script type="text/javascript" src="project.js">
 </script>
 <script type="text/javascript" src="stickydiv.js">
 </script>
 <script type="text/javascript" src="codeblocks.js">
 </script>
</head>
<body>
 <div class="hw" data-count="1" data-name="accelerometer"></div>
 <div class="hw" data-count="1" data-name="led_matrix"></div>
 <div class="hw" data-count="1" data-name="led_matrix_cable"></div>
 <div id="intro" class="section">

  <p>In this project, we will add in an LED Matrix and create a "balancing dot"
  &mdash; a single dot on the LED Matrix that moves around as we tilt the
  CREATOR Kit.  For this project, to keep things simple, we will only move the
  dot left and right on the LED Matrix.

 </div>
 <div id="hw" class="section">

  <p>You'll need to wire up both the Accelerometer and LED Matrix as done in
  previous projects.  Here is what your breadboard should look like once the
  accelerometer is properly wired:</p>
  <div style="text-align: center;"><img class="bb" src=
  "img/LED_Matrix_Accel_bb.jpg" alt=""></div>
 </div>
 <div id="sw" class="section">

  <p>For our first try, we're simply going to put a single dot on the screen and
  have it move left when the CREATOR Kit is tilted left, or move right when the
  CREATOR Kit is tilted right.
  <p>Most of the code should be very familiar, as it comes from the initial 
  <a data-uid="ledp"></a> project and <a data-uid="accelp"></a> project.  The code that's new is
  highlighted with arrows, below:

<div class="code" data-firstline="1">
   <textarea>
from rstem.accel import Accel
from rstem.sound import Note
import time

accel = Accel()

# Calibrate
z_rest = 0
SAMPLES = 100
for i in range(SAMPLES):
    x, y, z = accel.forces()
    z_rest += z
    time.sleep(0.01)
z_rest /= SAMPLES

# Beep to tell user we're starting recording
beep = Note('A6')
beep.play(0.2).wait()

# Record taps
TOTAL_TICKS = 2000
raw_tap_ticks = []
for i in range(TOTAL_TICKS):
    x, y, z = accel.forces()
    if abs(z_rest-z) > 0.1:
        raw_tap_ticks.append(i)
    time.sleep(0.001)

# Beep to tell user we've stopped recording
beep.play(0.2).wait()

# Convert raw ticks to absolute ticks
absolute_tap_ticks = []
previous_tick = None
for tick in raw_tap_ticks:
    if previous_tick == None or tick - previous_tick > 20:
        absolute_tap_ticks.append(tick)
    previous_tick = tick

# Convert absolute ticks to relative ticks
relative_tap_ticks = []
previous_tick = absolute_tap_ticks[0]
for tick in absolute_tap_ticks:
    relative_tap_ticks.append(tick - previous_tick)
    previous_tick = tick

*# Print actual taps
*chars_per_tick = TOTAL_TICKS/80
*print("Actual Knock:", relative_tap_ticks)
*if len(relative_tap_ticks) == 0:
*    print("No taps!")
*elif len(relative_tap_ticks) == 1:
*    print("Just one tap!")
*else:
*    for tap_tick in relative_tap_ticks:
*        spaces = int(80*tap_tick/TOTAL_TICKS)
*        print(" " *  spaces + "*", end="")
*    print()
*
*# Print the expected taps of the "secret knock"
*secret_knock = [0, 200, 100, 100, 200, 400, 200]
*print("Secret Knock:", secret_knock)
*
*# Compare actual taps to secret knock taps
*knock_passed = False
*if len(relative_tap_ticks) == len(secret_knock):
*    knock_passed = True
*    for i in range(len(relative_tap_ticks)):
*        if abs(relative_tap_ticks[i] - secret_knock[i]) > secret_knock[i] * 0.5:
*            knock_passed = False
*
*if knock_passed:
*    print("Access granted!")
*else:
*    print("Access DENIED!")
</textarea>
  </div>

  <p>The new addions we've made hgilight above are:</p>
  <ul>
   <li>

    <p>
    On Line 8, we define the <code>TILT_FORCE</code>.  The <code>TILT_FORCE</code> is how much we have to tilt the
    CREATOR Kit to make the dot move.
   </p></li> <li> <p>
    On Line 9, we define the <code>STEP</code>.  The <code>STEP</code> is how much we should move
    the dot while the CREATOR Kit is being tiled.  Note that <code>STEP</code> is small &mdash;
    it's less than one.
   </p></li> <li> <p>
    On Line 10, we define the starting coordinates of the dot.
   </p></li> <li> <p>
    On Lines 14 through 17, we move the dot if the CREATOR Kit is tilted.  The first part says: if
    the kit is tilted to the left (greater than the <code>TILT_FORCE</code>), then decrease the x
    position.  Alternatively, if tilted right (a negative <code>TILT_FORCE</code>), then increase
    the x position.
   </p></li> <li> <p>
    On Line 20, we draw the dot.  Notice that we use the built-in function
    <code>round()</code>.  We need this because our x position moves by
    fractional <code>STEP</code>s.  So, our x position is fractional, too
    &mdash; it might be something like 3.2.  However, the coordinates on the
    LED Matrix are <i>integers</i>.  Therefore, we must round them to the
    nearest integer (using the <code>round()</code> function).
  </ul>
 </div>
 <div id="challenge" class="section">
  <ol>
   <li> <p>
   Can you make the dot move faster when tilted?
    </p> </li> <li> <p>
   Can you make the dot tilt
    </p> </li> <li> <p>
  </ol>
 </div>
</body>
</html>
